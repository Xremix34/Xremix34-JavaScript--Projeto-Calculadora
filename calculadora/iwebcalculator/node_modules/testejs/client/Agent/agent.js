/**
 * Created by Administrator on 2016/11/10.
 */
var mysql = require("mysql");
var common = require("../../webconfig/common");
var apiUrl = require("../../webconfig/ApiUrl");
var Client = require('node-rest-client').Client;
var client = new Client();
var args = { headers: { "Content-Type": "application/json" } };
var MD5 = require("../../extends/helper/MD5");
var $config = require("../../config/db");
var $sql = require("../../operationDB/agent");
var pool = mysql.createPool($config.mysql);

var jsonWrite = function(res, ret) {
    if (typeof ret === "undefined") {
        res.json({
            code: "1",
            msg: "操作失败"
        });
    } else {
        res.json(ret);
    }
};
module.exports = {
    queryAgent: function(req, res, next) {
        pool.getConnection(function(err, connection) {
            connection.query($sql.queryAll, function(err, result) {
                jsonWrite(res, result);
                connection.release();
            });
        });
    },
    Limit: function(req, res, next) {
        pool.getConnection(function(err, connection) {
            connection.query("SELECT * FROM bx_agent LIMIT " + req.body.pageIndex + "," + $sql.pageSize + " ", function(err, result) {
                jsonWrite(res, result);
                connection.release();
            });
        });
    }
};